# Создание EXE файла для SpeechToText

## ⚠️ ВАЖНО: Не рекомендуется!

Создание EXE файла для этой программы **НЕ РЕКОМЕНДУЕТСЯ** по следующим причинам:

### Проблемы:
1. **Огромный размер** - EXE будет 100+ МБ из-за PyTorch, Whisper и зависимостей
2. **Долгая сборка** - PyInstaller будет собирать 10-30 минут
3. **Первый запуск долгий** - Whisper модель загружается при первом запуске
4. **Антивирусы** - могут блокировать (false positive)
5. **Обновления сложные** - нужно пересобирать EXE

### Рекомендуемые альтернативы:

#### Вариант 1: Ярлык на START.bat (Лучший вариант! ⭐)
1. Правой кнопкой на **START.bat** → "Создать ярлык"
2. Перетащите ярлык на рабочий стол
3. (Опционально) Правой кнопкой → "Свойства" → "Сменить значок"
4. Готово! Запускается одним кликом

**Преимущества:**
- Быстрый запуск
- Легко обновлять (просто меняете Python файл)
- Нет проблем с антивирусами
- Консоль показывает статус работы

#### Вариант 2: Автозагрузка Windows
1. Создайте ярлык на START.bat
2. Нажмите Win+R → `shell:startup` → Enter
3. Скопируйте ярлык в открывшуюся папку
4. Программа будет запускаться при включении компьютера

## Если всё же нужен EXE

### Способ 1: Использовать build_exe.bat

```bash
build_exe.bat
```

Следуйте инструкциям на экране. Процесс займёт 10-30 минут.

### Способ 2: Вручную через PyInstaller

1. Установите PyInstaller:
```bash
.venv\Scripts\pip.exe install pyinstaller
```

2. Соберите EXE:
```bash
.venv\Scripts\pyinstaller.exe --onefile --name="SpeechToText" ^
    --hidden-import=whisper ^
    --hidden-import=torch ^
    --collect-all whisper ^
    --collect-all torch ^
    SpeechToText.py
```

3. Найдите EXE в папке `dist\SpeechToText.exe`

### После сборки:

1. **Первый запуск:**
   - Whisper модель загрузится (500MB - 1.5GB в зависимости от model_size)
   - Модели сохраняются в: `C:\Users\ВашеИмя\.cache\whisper\`
   - Занимает 5-15 минут

2. **Антивирус:**
   - Может заблокировать EXE (ложное срабатывание)
   - Добавьте в исключения антивируса
   - Или используйте BAT файл (рекомендуется)

3. **Права администратора:**
   - Могут потребоваться для глобального захвата мыши
   - Правой кнопкой → "Запуск от имени администратора"

## Альтернатива: Системный сервис

Если нужна программа, работающая в фоне постоянно:

### Windows Task Scheduler:
1. Откройте "Планировщик заданий"
2. "Создать задачу"
3. Триггер: "При входе в систему"
4. Действие: Запустить программу → `E:\Prog\ml\SpeechToText\START.bat`
5. Настройки: "Выполнять для всех пользователей"

### NSSM (Non-Sucking Service Manager):
1. Скачайте NSSM: https://nssm.cc/download
2. Установите как сервис:
```bash
nssm install SpeechToText "E:\Prog\ml\SpeechToText\.venv\Scripts\python.exe" "E:\Prog\ml\SpeechToText\SpeechToText.py"
nssm start SpeechToText
```

## Заключение

**Рекомендация:** Используйте ярлык на START.bat - это проще, быстрее и надежнее!

EXE файл имеет смысл только если:
- Нужно распространять программу другим пользователям
- На целевых компьютерах нет Python
- Готовы мириться с большим размером файла

Для личного использования ярлык на BAT файл - оптимальное решение.
